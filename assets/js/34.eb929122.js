(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{412:function(e,t,a){"use strict";a.r(t);var r=a(11),n=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"元数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#元数据"}},[e._v("#")]),e._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/metadata/#metadata",target:"_blank",rel:"noopener noreferrer"}},[e._v("元数据"),a("OutboundLink")],1)]),e._v(" "),a("blockquote",[a("p",[e._v("[ "),a("code",[e._v("OPTIONS")]),e._v("]方法允许客户端确定与资源相关联的选项和/或要求或服务器的功能，而无需暗示资源操作或启动资源检索。")]),e._v(" "),a("p",[e._v("— "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc7231#section-4.3.7",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC7231，第4.3.7节。"),a("OutboundLink")],1)])]),e._v(" "),a("p",[e._v("REST框架包括一种可配置的机制，用于确定您的API如何响应"),a("code",[e._v("OPTIONS")]),e._v("请求。这使您可以返回API模式或其他资源信息。")]),e._v(" "),a("p",[e._v("目前，对于HTTP "),a("code",[e._v("OPTIONS")]),e._v("请求应返回哪种响应样式，目前还没有广泛采用的约定，因此我们提供了一种临时样式，可以返回一些有用的信息。")]),e._v(" "),a("p",[e._v("这是一个示例响应，演示了默认情况下返回的信息。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('HTTP 200 OK\nAllow: GET, POST, HEAD, OPTIONS\nContent-Type: application/json\n\n{\n    "name": "To Do List",\n    "description": "List existing \'To Do\' items, or create a new item.",\n    "renders": [\n        "application/json",\n        "text/html"\n    ],\n    "parses": [\n        "application/json",\n        "application/x-www-form-urlencoded",\n        "multipart/form-data"\n    ],\n    "actions": {\n        "POST": {\n            "note": {\n                "type": "string",\n                "required": false,\n                "read_only": false,\n                "label": "title",\n                "max_length": 100\n            }\n        }\n    }\n}\n')])])]),a("h2",{attrs:{id:"设置元数据方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置元数据方案"}},[e._v("#")]),e._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/metadata/#setting-the-metadata-scheme",target:"_blank",rel:"noopener noreferrer"}},[e._v("设置元数据方案"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("您可以使用"),a("code",[e._v("'DEFAULT_METADATA_CLASS'")]),e._v("设置键全局设置元数据类：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("REST_FRAMEWORK = {\n    'DEFAULT_METADATA_CLASS': 'rest_framework.metadata.SimpleMetadata'\n}\n")])])]),a("p",[e._v("或者，您可以为视图单独设置元数据类：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("class APIRoot(APIView):\n    metadata_class = APIRootMetadata\n\n    def get(self, request, format=None):\n        return Response({\n            ...\n        })\n")])])]),a("p",[e._v("REST框架包仅包含一个名为的元数据类实现"),a("code",[e._v("SimpleMetadata")]),e._v("。如果要使用其他样式，则需要实现自定义元数据类。")]),e._v(" "),a("h2",{attrs:{id:"创建模式端点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建模式端点"}},[e._v("#")]),e._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/metadata/#creating-schema-endpoints",target:"_blank",rel:"noopener noreferrer"}},[e._v("创建模式端点"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("如果您对创建可通过常规"),a("code",[e._v("GET")]),e._v("请求访问的架构终结点有特定要求，则可以考虑重新使用元数据API。")]),e._v(" "),a("p",[e._v("例如，可以在视图集上使用以下附加路由来提供可链接的架构端点。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("@action(methods=['GET'], detail=False)\ndef schema(self, request):\n    meta = self.metadata_class()\n    data = meta.determine_metadata(request, self)\n    return Response(data)\n")])])]),a("p",[e._v("您可能会选择采用这种方法的原因有两个，包括"),a("code",[e._v("OPTIONS")]),e._v("响应"),a("a",{attrs:{href:"https://www.mnot.net/blog/2012/10/29/NO_OPTIONS",target:"_blank",rel:"noopener noreferrer"}},[e._v("不可缓存"),a("OutboundLink")],1),e._v("。")]),e._v(" "),a("hr"),e._v(" "),a("h1",{attrs:{id:"自定义元数据类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义元数据类"}},[e._v("#")]),e._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/metadata/#custom-metadata-classes",target:"_blank",rel:"noopener noreferrer"}},[e._v("自定义元数据类"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("如果要提供自定义元数据类，则应重写"),a("code",[e._v("BaseMetadata")]),e._v("并实现该"),a("code",[e._v("determine_metadata(self, request, view)")]),e._v("方法。")]),e._v(" "),a("p",[e._v("您可能想做的有用的事情可能包括使用"),a("a",{attrs:{href:"https://json-schema.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSON模式之"),a("OutboundLink")],1),e._v("类的格式返回模式信息，或将调试信息返回给管理员用户。")]),e._v(" "),a("h2",{attrs:{id:"例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例"}},[e._v("#")]),e._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/metadata/#example",target:"_blank",rel:"noopener noreferrer"}},[e._v("例"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("下列类可用于限制返回给"),a("code",[e._v("OPTIONS")]),e._v("请求的信息。")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('class MinimalMetadata(BaseMetadata):\n    """\n    Don\'t include field and other information for `OPTIONS` requests.\n    Just return the name and description.\n    """\n    def determine_metadata(self, request, view):\n        return {\n            \'name\': view.get_view_name(),\n            \'description\': view.get_view_description()\n        }\n')])])]),a("p",[e._v("然后配置您的设置以使用此自定义类：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("REST_FRAMEWORK = {\n    'DEFAULT_METADATA_CLASS': 'myproject.apps.core.MinimalMetadata'\n}\n")])])]),a("h1",{attrs:{id:"第三方套餐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三方套餐"}},[e._v("#")]),e._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/metadata/#third-party-packages",target:"_blank",rel:"noopener noreferrer"}},[e._v("第三方套餐"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("以下第三方软件包提供了其他元数据实现。")]),e._v(" "),a("h2",{attrs:{id:"drf模式适配器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#drf模式适配器"}},[e._v("#")]),e._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/metadata/#drf-schema-adapter",target:"_blank",rel:"noopener noreferrer"}},[e._v("DRF模式适配器"),a("OutboundLink")],1)]),e._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/drf-forms/drf-schema-adapter",target:"_blank",rel:"noopener noreferrer"}},[e._v("drf-schema-adapter"),a("OutboundLink")],1),e._v("是一组工具，可简化向前端框架和库提供架构信息的过程。它提供了一个元数据mixin以及2个元数据类和几个适配器，这些适配器适合生成"),a("a",{attrs:{href:"https://json-schema.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("json模式"),a("OutboundLink")],1),e._v("以及各种库可读的模式信息。")]),e._v(" "),a("p",[e._v("您也可以编写自己的适配器以与特定的前端一起使用。如果您愿意，它还提供了一个导出器，可以将那些模式信息导出到json文件中。")])])}),[],!1,null,null,null);t.default=n.exports}}]);