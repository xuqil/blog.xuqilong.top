(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{428:function(t,s,a){"use strict";a.r(s);var e=a(11),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"routers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#routers"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#routers",target:"_blank",rel:"noopener noreferrer"}},[t._v("Routers"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("资源路由允许您快速声明给定资源控制器的所有通用路由。无需为索引声明单独的路由，而是在单行代码中声明资源丰富的路由。")]),t._v(" "),a("p",[t._v("— "),a("a",{attrs:{href:"https://guides.rubyonrails.org/routing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ruby on Rails文档"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("一些Web框架（例如Rails）提供了自动确定应用程序的URL应如何映射到处理传入请求的逻辑的功能。")]),t._v(" "),a("p",[t._v("REST框架增加了对将自动URL路由到Django的支持，并为您提供了一种简单，快速且一致的方式将视图逻辑连接到一组URL。")]),t._v(" "),a("h2",{attrs:{id:"用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用法"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#usage",target:"_blank",rel:"noopener noreferrer"}},[t._v("用法"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("这是一个使用的简单URL conf的示例"),a("code",[t._v("SimpleRouter")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" rest_framework "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" routers\n\nrouter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" routers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SimpleRouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'users'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" UserViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'accounts'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AccountViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nurlpatterns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urls\n")])])]),a("p",[t._v("该方法有两个强制性参数"),a("code",[t._v("register()")]),t._v("：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("prefix")]),t._v(" -用于这组路由的URL前缀。")]),t._v(" "),a("li",[a("code",[t._v("viewset")]),t._v(" -视图集类。")])]),t._v(" "),a("p",[t._v("（可选）您还可以指定其他参数：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("basename")]),t._v("-用于创建的URL名称的基础。如果未设置，则基名称将基于"),a("code",[t._v("queryset")]),t._v("视图集的属性自动生成（如果有）。请注意，如果视图集不包含"),a("code",[t._v("queryset")]),t._v("属性，则必须"),a("code",[t._v("basename")]),t._v("在注册视图集时进行设置。")])]),t._v(" "),a("p",[t._v("上面的示例将生成以下URL模式：")]),t._v(" "),a("ul",[a("li",[t._v("网址格式："),a("code",[t._v("^users/$")]),t._v(" 名称："),a("code",[t._v("'user-list'")])]),t._v(" "),a("li",[t._v("网址格式："),a("code",[t._v("^users/{pk}/$")]),t._v(" 名称："),a("code",[t._v("'user-detail'")])]),t._v(" "),a("li",[t._v("网址格式："),a("code",[t._v("^accounts/$")]),t._v(" 名称："),a("code",[t._v("'account-list'")])]),t._v(" "),a("li",[t._v("网址格式："),a("code",[t._v("^accounts/{pk}/$")]),t._v(" 名称："),a("code",[t._v("'account-detail'")])])]),t._v(" "),a("hr"),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("：该"),a("code",[t._v("basename")]),t._v("参数用于指定视图名称模式的初始部分。在上面的示例中，这就是“ "),a("code",[t._v("user")]),t._v("或” "),a("code",[t._v("account")]),t._v("部分。")]),t._v(" "),a("p",[t._v("通常，您"),a("em",[t._v("不需要")]),t._v("指定"),a("code",[t._v("basename")]),t._v("参数，但是如果您有一个定义了自定义"),a("code",[t._v("get_queryset")]),t._v("方法的视图"),a("code",[t._v(".queryset")]),t._v("集，则该视图集可能没有属性集。如果尝试注册该视图集，则会看到类似以下错误：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'basename'")]),t._v(" argument "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" specified"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("and")]),t._v(" could "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" automatically determine the name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" the viewset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" it does "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" have a "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.queryset'")]),t._v(" attribute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("这意味着"),a("code",[t._v("basename")]),t._v("注册视图集时需要显式设置参数，因为无法从模型名称自动确定该参数。")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"include与路由器一起使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#include与路由器一起使用"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#using-include-with-routers",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("include")]),t._v("与路由器一起使用"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("code",[t._v(".urls")]),t._v("路由器实例上的属性只是URL模式的标准列表。关于如何包含这些URL，有很多不同的样式。")]),t._v(" "),a("p",[t._v("例如，您可以追加"),a("code",[t._v("router.urls")]),t._v("到现有视图的列表中...")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("router "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" routers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SimpleRouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'users'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" UserViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'accounts'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AccountViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nurlpatterns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^forgot-password/$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ForgotPasswordFormView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nurlpatterns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urls\n")])])]),a("p",[t._v("另外，您也可以使用Django的"),a("code",[t._v("include")]),t._v("功能，例如...")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("urlpatterns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^forgot-password/$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ForgotPasswordFormView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" include"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("您可以使用"),a("code",[t._v("include")]),t._v("应用程序名称空间：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("urlpatterns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^forgot-password/$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ForgotPasswordFormView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^api/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" include"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("或应用程序和实例名称空间：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("urlpatterns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^forgot-password/$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ForgotPasswordFormView"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_view"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^api/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" include"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'app_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" namespace"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'instance_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("有关更多详细信息，请参见Django的"),a("a",{attrs:{href:"https://docs.djangoproject.com/en/3.0/topics/http/urls/",target:"_blank",rel:"noopener noreferrer"}},[t._v("URL名称空间文档"),a("OutboundLink")],1),t._v("和"),a("a",{attrs:{href:"https://docs.djangoproject.com/en/2.0/ref/urls/#include",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("include")]),t._v("API参考"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("hr"),t._v(" "),a("p",[a("strong",[t._v("注意")]),t._v("：如果将命名空间与超链接的序列化程序一起使用，则还需要确保"),a("code",[t._v("view_name")]),t._v("序列化程序上的所有参数都能正确反映名称空间。在上面的示例中，您需要包括一个参数，例如"),a("code",[t._v("view_name='app_name:user-detail'")]),t._v("超链接到用户详细信息视图的序列化程序字段的参数 。")]),t._v(" "),a("p",[t._v("自动"),a("code",[t._v("view_name")]),t._v("生成使用的模式"),a("code",[t._v("%(model_name)-detail")]),t._v("。除非您的模型名称实际发生冲突，否则在使用超链接序列化程序时最好"),a("strong",[t._v("不要为")]),t._v(" Django REST Framework视图命名。")]),t._v(" "),a("hr"),t._v(" "),a("h3",{attrs:{id:"额外操作的路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#额外操作的路由"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#routing-for-extra-actions",target:"_blank",rel:"noopener noreferrer"}},[t._v("额外操作的路由"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("视图集可以通过用装饰器装饰方法来"),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/viewsets/#marking-extra-actions-for-routing",target:"_blank",rel:"noopener noreferrer"}},[t._v("标记用于路由"),a("OutboundLink")],1),t._v("的"),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/viewsets/#marking-extra-actions-for-routing",target:"_blank",rel:"noopener noreferrer"}},[t._v("额外操作"),a("OutboundLink")],1),a("code",[t._v("@action")]),t._v("。这些额外的动作将包含在生成的路线中。例如，给定类的"),a("code",[t._v("set_password")]),t._v("方法"),a("code",[t._v("UserViewSet")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" myapp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permissions "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" IsAdminOrIsSelf\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" rest_framework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decorators "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" action\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserViewSet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ModelViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'post'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" detail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" permission_classes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("IsAdminOrIsSelf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pk"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("将生成以下路线：")]),t._v(" "),a("ul",[a("li",[t._v("网址格式： "),a("code",[t._v("^users/{pk}/set_password/$")])]),t._v(" "),a("li",[t._v("网址名称： "),a("code",[t._v("'user-set-password'")])])]),t._v(" "),a("p",[t._v("默认情况下，URL模式基于方法命名，URL名称是"),a("code",[t._v("ViewSet.basename")]),t._v("和连字符方法名的组合。如果您不想对这些值中的任何一个使用默认值，您可以改为向"),a("code",[t._v("@action")]),t._v(" 装饰器提供"),a("code",[t._v("url_path")]),t._v("和 "),a("code",[t._v("url_name")]),t._v("参数。")]),t._v(" "),a("p",[t._v("例如，如果要将我们的自定义操作的URL更改为"),a("code",[t._v("^users/{pk}/change-password/$")]),t._v("，则可以编写：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" myapp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permissions "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" IsAdminOrIsSelf\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" rest_framework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("decorators "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" action\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserViewSet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ModelViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'post'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" detail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" permission_classes"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("IsAdminOrIsSelf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            url_path"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'change-password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url_name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'change_password'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set_password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pk"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("上面的示例现在将生成以下URL模式：")]),t._v(" "),a("ul",[a("li",[t._v("网址路径： "),a("code",[t._v("^users/{pk}/change-password/$")])]),t._v(" "),a("li",[t._v("网址名称： "),a("code",[t._v("'user-change_password'")])])]),t._v(" "),a("h1",{attrs:{id:"api指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api指南"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#api-guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("API指南"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"simplerouter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#simplerouter"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#simplerouter",target:"_blank",rel:"noopener noreferrer"}},[t._v("SimpleRouter"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("该路由器包括一套标准的途径"),a("code",[t._v("list")]),t._v("，"),a("code",[t._v("create")]),t._v("，"),a("code",[t._v("retrieve")]),t._v("，"),a("code",[t._v("update")]),t._v("，"),a("code",[t._v("partial_update")]),t._v("和"),a("code",[t._v("destroy")]),t._v("行动。视图集还可以使用"),a("code",[t._v("@action")]),t._v("装饰器标记路由的其他方法。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("URL Style")]),t._v(" "),a("th",[t._v("HTTP Method")]),t._v(" "),a("th",[t._v("Action")]),t._v(" "),a("th",[t._v("URL Name")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("{prefix}/")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("list")]),t._v(" "),a("td",[t._v("{basename}-list")])]),t._v(" "),a("tr",[a("td",[t._v("POST")]),t._v(" "),a("td",[t._v("create")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("{prefix}/{url_path}/")]),t._v(" "),a("td",[t._v("GET, 或由"),a("code",[t._v("methods")]),t._v("参数指定")]),t._v(" "),a("td",[a("code",[t._v("@action(detail=False)")]),t._v(" decorated method")]),t._v(" "),a("td",[t._v("{basename}-{url_name}")])]),t._v(" "),a("tr",[a("td",[t._v("{prefix}/{lookup}/")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("retrieve")]),t._v(" "),a("td",[t._v("{basename}-detail")])]),t._v(" "),a("tr",[a("td",[t._v("PUT")]),t._v(" "),a("td",[t._v("update")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("PATCH")]),t._v(" "),a("td",[t._v("partial_update")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("DELETE")]),t._v(" "),a("td",[t._v("destroy")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("{prefix}/{lookup}/{url_path}/")]),t._v(" "),a("td",[t._v("GET, 或由"),a("code",[t._v("methods")]),t._v("参数指定")]),t._v(" "),a("td",[a("code",[t._v("@action(detail=True)")]),t._v(" decorated method")]),t._v(" "),a("td",[t._v("{basename}-{url_name}")])])])]),t._v(" "),a("p",[t._v("默认情况下，"),a("code",[t._v("SimpleRoute")]),t._v("r创建的url会附加一个斜杠。在实例化路由器时，可以通过将尾部的斜杠参数设置为"),a("code",[t._v("False")]),t._v("来修改此行为。例如：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("router "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" SimpleRouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("trailing_slash"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("尾部的斜杠在Django中是常规的，但在其他一些框架（例如Rails）中默认不使用。尽管有些JavaScript框架可能期望使用特定的路由样式，但是选择使用哪种样式在很大程度上取决于首选项。")]),t._v(" "),a("p",[t._v("路由器将匹配包含除斜杠和句点字符以外的任何字符的查找值。对于更严格（或更宽松）的查找模式，请"),a("code",[t._v("lookup_value_regex")]),t._v("在视图集上设置属性。例如，您可以将查找限制为有效的UUID：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MyModelViewSet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mixins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RetrieveModelMixin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" viewsets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("GenericViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    lookup_field "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my_model_id'")]),t._v("\n    lookup_value_regex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[0-9a-f]{32}'")]),t._v("\n")])])]),a("h2",{attrs:{id:"defaultrouter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#defaultrouter"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#defaultrouter",target:"_blank",rel:"noopener noreferrer"}},[t._v("DefaultRouter"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("该路由器与"),a("code",[t._v("SimpleRouter")]),t._v("上面类似，但是还包括一个默认的API根视图，该根视图返回一个响应，其中包含指向所有列表视图的超链接。它还为可选"),a("code",[t._v(".json")]),t._v("样式格式后缀生成路由。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("URL Style")]),t._v(" "),a("th",[t._v("HTTP Method")]),t._v(" "),a("th",[t._v("Action")]),t._v(" "),a("th",[t._v("URL Name")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("[.format]")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("自动生成的根视图")]),t._v(" "),a("td",[t._v("api-root")])]),t._v(" "),a("tr",[a("td",[t._v("{prefix}/[.format]")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("list")]),t._v(" "),a("td",[t._v("{basename}-list")])]),t._v(" "),a("tr",[a("td",[t._v("POST")]),t._v(" "),a("td",[t._v("create")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("{prefix}/{url_path}/[.format]")]),t._v(" "),a("td",[t._v("GET, 或由“methods”参数指定")]),t._v(" "),a("td",[a("code",[t._v("@action(detail=False)")]),t._v(" decorated method")]),t._v(" "),a("td",[t._v("{basename}-{url_name}")])]),t._v(" "),a("tr",[a("td",[t._v("{prefix}/{lookup}/[.format]")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("retrieve")]),t._v(" "),a("td",[t._v("{basename}-detail")])]),t._v(" "),a("tr",[a("td",[t._v("PUT")]),t._v(" "),a("td",[t._v("update")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("PATCH")]),t._v(" "),a("td",[t._v("partial_update")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("DELETE")]),t._v(" "),a("td",[t._v("destroy")]),t._v(" "),a("td"),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("{prefix}/{lookup}/{url_path}/[.format]")]),t._v(" "),a("td",[t._v("GET, 或由“methods”参数指定")]),t._v(" "),a("td",[a("code",[t._v("@action(detail=True)")]),t._v(" decorated method")]),t._v(" "),a("td",[t._v("{basename}-{url_name}")])])])]),t._v(" "),a("p",[t._v("与"),a("code",[t._v("SimpleRouter")]),t._v("一样，在实例化路由器时，可以通过将"),a("code",[t._v("trailing_slash")]),t._v("参数设置为"),a("code",[t._v("False")]),t._v("来删除URL路由上的尾部斜杠。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("router "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DefaultRouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("trailing_slash"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h1",{attrs:{id:"自定义路由器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义路由器"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#custom-routers",target:"_blank",rel:"noopener noreferrer"}},[t._v("自定义路由器"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("实施定制路由器并不是您经常需要做的事情，但是如果您对API的URL的结构有特定要求，这将很有用。这样做可以使您以可重用的方式封装URL结构，从而确保您不必为每个新视图明确编写URL模式。")]),t._v(" "),a("p",[t._v("实现自定义路由器的最简单方法是将现有路由器类之一作为子类。该"),a("code",[t._v(".routes")]),t._v("属性用于模板化将映射到每个视图集的URL模式。该"),a("code",[t._v(".routes")]),t._v("属性是"),a("code",[t._v("Route")]),t._v("命名元组的列表。")]),t._v(" "),a("p",[a("code",[t._v("Route")]),t._v("命名元组的参数为：")]),t._v(" "),a("p",[a("strong",[t._v("url")]),t._v("：一个字符串，代表要路由的URL。可能包含以下格式字符串：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("{prefix}")]),t._v(" -用于这组路由的URL前缀。")]),t._v(" "),a("li",[a("code",[t._v("{lookup}")]),t._v(" -用于与单个实例匹配的查找字段。")]),t._v(" "),a("li",[a("code",[t._v("{trailing_slash}")]),t._v("-根据"),a("code",[t._v("trailing_slash")]),t._v("参数，是'/'还是空字符串。")])]),t._v(" "),a("p",[a("strong",[t._v("mapping")]),t._v("：HTTP方法名称到视图方法的映射")]),t._v(" "),a("p",[a("strong",[t._v("name")]),t._v("："),a("code",[t._v("reverse")]),t._v("呼叫中使用的URL名称。可能包含以下格式字符串：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("{basename}")]),t._v(" -用于创建的URL名称的基础。")])]),t._v(" "),a("p",[a("strong",[t._v("initkwargs")]),t._v("：实例化视图时应传递的所有其他参数的字典。请注意，"),a("code",[t._v("detail")]),t._v("，"),a("code",[t._v("basename")]),t._v("，和"),a("code",[t._v("suffix")]),t._v("参数保留给视图集中内省和也使用可浏览的API生成视图名称和面包屑链接。")]),t._v(" "),a("h2",{attrs:{id:"自定义动态路线"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义动态路线"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#customizing-dynamic-routes",target:"_blank",rel:"noopener noreferrer"}},[t._v("自定义动态路线"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("您还可以自定义"),a("code",[t._v("@action")]),t._v("装饰器的路由方式。"),a("code",[t._v("DynamicRoute")]),t._v("在"),a("code",[t._v(".routes")]),t._v("列表中包括命名的元组，将"),a("code",[t._v("detail")]),t._v("参数设置为适用于基于列表的路由和基于详细信息的路由。除了"),a("code",[t._v("detail")]),t._v("，参数为"),a("code",[t._v("DynamicRoute")]),t._v("：")]),t._v(" "),a("p",[a("strong",[t._v("url")]),t._v("：一个字符串，代表要路由的URL。可能包含与相同的格式字符串"),a("code",[t._v("Route")]),t._v("，并且另外接受"),a("code",[t._v("{url_path}")]),t._v("格式字符串。")]),t._v(" "),a("p",[a("strong",[t._v("name")]),t._v("："),a("code",[t._v("reverse")]),t._v("呼叫中使用的URL名称。可能包含以下格式字符串：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("{basename}")]),t._v(" -用于创建的URL名称的基础。")]),t._v(" "),a("li",[a("code",[t._v("{url_name}")]),t._v("- "),a("code",[t._v("url_name")]),t._v("提供给"),a("code",[t._v("@action")]),t._v("。")])]),t._v(" "),a("p",[a("strong",[t._v("initkwargs")]),t._v("：实例化视图时应传递的所有其他参数的字典。")]),t._v(" "),a("h2",{attrs:{id:"例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#example",target:"_blank",rel:"noopener noreferrer"}},[t._v("例"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("以下示例将仅路由到"),a("code",[t._v("list")]),t._v("和"),a("code",[t._v("retrieve")]),t._v("操作，并且不使用尾部斜杠约定。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" rest_framework"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("routers "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" DynamicRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SimpleRouter\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CustomReadOnlyRouter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("SimpleRouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n    A router for read-only APIs, which doesn\'t use trailing slashes.\n    """')]),t._v("\n    routes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        Route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^{prefix}$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            mapping"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'get'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{basename}-list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            detail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            initkwargs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'suffix'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'List'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        Route"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^{prefix}/{lookup}$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            mapping"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'get'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'retrieve'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{basename}-detail'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            detail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            initkwargs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'suffix'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Detail'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        DynamicRoute"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'^{prefix}/{lookup}/{url_path}$'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{basename}-{url_name}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            detail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            initkwargs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[t._v("让我们看一下我们"),a("code",[t._v("CustomReadOnlyRouter")]),t._v("将为简单视图集生成的路线。")]),t._v(" "),a("p",[a("code",[t._v("views.py")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserViewSet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("viewsets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReadOnlyModelViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n    A viewset that provides the standard actions\n    """')]),t._v("\n    queryset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" User"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("all")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    serializer_class "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" UserSerializer\n    lookup_field "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'username'")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@action")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("detail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("group_names")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pk"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n        Returns a list of all the group names that the given\n        user belongs to.\n        """')]),t._v("\n        user "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        groups "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("groups"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("all")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" group "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" groups"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("code",[t._v("urls.py")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("router "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomReadOnlyRouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nrouter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'users'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" UserViewSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nurlpatterns "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("urls\n")])])]),a("p",[t._v("将生成以下映射...")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("URL")]),t._v(" "),a("th",[t._v("HTTP Method")]),t._v(" "),a("th",[t._v("Action")]),t._v(" "),a("th",[t._v("URL Name")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("/users")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("list")]),t._v(" "),a("td",[t._v("user-list")])]),t._v(" "),a("tr",[a("td",[t._v("/users/{username}")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("retrieve")]),t._v(" "),a("td",[t._v("user-detail")])]),t._v(" "),a("tr",[a("td",[t._v("/users/{username}/group_names")]),t._v(" "),a("td",[t._v("GET")]),t._v(" "),a("td",[t._v("group_names")]),t._v(" "),a("td",[t._v("user-group-names")])])])]),t._v(" "),a("p",[t._v("有关设置"),a("code",[t._v(".routes")]),t._v("属性的另一个示例，请参见"),a("code",[t._v("SimpleRouter")]),t._v("该类的源代码。")]),t._v(" "),a("h2",{attrs:{id:"高级自定义路由器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高级自定义路由器"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#advanced-custom-routers",target:"_blank",rel:"noopener noreferrer"}},[t._v("高级自定义路由器"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("如果要提供完全自定义的行为，则可以重写"),a("code",[t._v("BaseRouter")]),t._v("和重写该"),a("code",[t._v("get_urls(self)")]),t._v("方法。该方法应检查已注册的视图集并返回URL模式列表。可以通过访问"),a("code",[t._v("self.registry")]),t._v("属性来检查已注册的前缀，视图集和基本名称元组。")]),t._v(" "),a("p",[t._v("您可能还想覆盖该"),a("code",[t._v("get_default_basename(self, viewset)")]),t._v("方法，或者"),a("code",[t._v("basename")]),t._v("在向路由器注册视图集时始终显式设置参数。")]),t._v(" "),a("h1",{attrs:{id:"第三方软件包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三方软件包"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#third-party-packages",target:"_blank",rel:"noopener noreferrer"}},[t._v("第三方软件包"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("以下第三方软件包也可用。")]),t._v(" "),a("h2",{attrs:{id:"drf嵌套路由器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#drf嵌套路由器"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#drf-nested-routers",target:"_blank",rel:"noopener noreferrer"}},[t._v("DRF嵌套路由器"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("的"),a("a",{attrs:{href:"https://github.com/alanjds/drf-nested-routers",target:"_blank",rel:"noopener noreferrer"}},[t._v("DRF-嵌套的路由器包"),a("OutboundLink")],1),t._v("提供路由器和关系字段用于与嵌套资源工作。")]),t._v(" "),a("h2",{attrs:{id:"modelrouter-wq-db-rest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#modelrouter-wq-db-rest"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#modelrouter-wqdbrest",target:"_blank",rel:"noopener noreferrer"}},[t._v("ModelRouter（wq.db.rest）"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("所述"),a("a",{attrs:{href:"https://wq.io/wq.db",target:"_blank",rel:"noopener noreferrer"}},[t._v("wq.db包"),a("OutboundLink")],1),t._v("提供了一个先进"),a("a",{attrs:{href:"https://wq.io/docs/router",target:"_blank",rel:"noopener noreferrer"}},[t._v("ModelRouter"),a("OutboundLink")],1),t._v("延伸类（和单个实例）"),a("code",[t._v("DefaultRouter")]),t._v("用"),a("code",[t._v("register_model()")]),t._v("的API。就像Django一样"),a("code",[t._v("admin.site.register")]),t._v("，唯一需要的参数"),a("code",[t._v("rest.router.register_model")]),t._v("是模型类。可以从模型和全局配置中推断出URL前缀，序列化程序和视图集的合理默认值。")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" wq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("db "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" rest\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" myapp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("models "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MyModel\n\nrest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register_model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MyModel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"drf扩展"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#drf扩展"}},[t._v("#")]),t._v(" "),a("a",{attrs:{href:"https://www.django-rest-framework.org/api-guide/routers/#drf-extensions",target:"_blank",rel:"noopener noreferrer"}},[t._v("DRF扩展"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("该"),a("a",{attrs:{href:"https://chibisov.github.io/drf-extensions/docs/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("DRF-extensions")]),t._v("软件包"),a("OutboundLink")],1),t._v("提供了"),a("a",{attrs:{href:"https://chibisov.github.io/drf-extensions/docs/#routers",target:"_blank",rel:"noopener noreferrer"}},[t._v("路由器"),a("OutboundLink")],1),t._v("创建"),a("a",{attrs:{href:"https://chibisov.github.io/drf-extensions/docs/#nested-routes",target:"_blank",rel:"noopener noreferrer"}},[t._v("嵌套viewsets"),a("OutboundLink")],1),t._v("，"),a("a",{attrs:{href:"https://chibisov.github.io/drf-extensions/docs/#collection-level-controllers",target:"_blank",rel:"noopener noreferrer"}},[t._v("收藏级控制器"),a("OutboundLink")],1),t._v("与"),a("a",{attrs:{href:"https://chibisov.github.io/drf-extensions/docs/#controller-endpoint-name",target:"_blank",rel:"noopener noreferrer"}},[t._v("定制的端点名"),a("OutboundLink")],1),t._v("。")])])}),[],!1,null,null,null);s.default=r.exports}}]);