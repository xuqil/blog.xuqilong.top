(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{437:function(t,n,s){"use strict";s.r(n);var e=s(11),a=Object(e.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"正则表达式匹配例子"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#正则表达式匹配例子"}},[t._v("#")]),t._v(" 正则表达式匹配例子")]),t._v(" "),s("h3",{attrs:{id:"特殊文件配置匹配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特殊文件配置匹配"}},[t._v("#")]),t._v(" 特殊文件配置匹配")]),t._v(" "),s("p",[t._v("匹配文件中"),s("code",[t._v("[特定字符串开头] [类型] [名称] [{值}]")])]),t._v(" "),s("p",[t._v("如从如下配置文件中匹配"),s("code",[t._v("ltm node 名称 {空值}")]),t._v("和"),s("code",[t._v("ltm node 名称 {有换行的值}")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ltm node /Common/test4 {\n    address 192.168.56.22\n}\nltm node /Common/test5 { }\nltm pool /Common/test1 { }\nltm pool /Common/mypool {\n    description 测试pool\n    load-balancing-mode ratio-member\n    members {\n        /Common/test:80 {\n            address 192.168.56.20\n            description 测试number\n            priority-group 1\n            rate-limit 1\n            ratio 3\n        }\n        /Common/test22:80 {\n            address 192.168.56.22\n            description 测试number2\n        }\n        /Common/test3:80 {\n            address 192.168.56.11\n            description 测试三\n        }\n        /Common/test6:80 {\n            address 192.168.56.12\n            description 111\n            monitor /Common/http\n        }\n    }\n    min-active-members 2\n    monitor /Common/tcp\n    queue-depth-limit 2\n    queue-time-limit 1\n    reselect-tries 3\n}\nltm pool /Common/test {\n    monitor /Common/http\n}\nltm pool /Common/test5 { }\nltm rule /Common/test {\n\n}\n")])])]),s("p",[s("strong",[t._v("思路")])]),t._v(" "),s("p",[t._v("开头的特定字符串和名字比较容易匹配，但是后面的值有两种情况。")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("第一种是空值，只有一个大括号括着一个空格"),s("code",[t._v("{ }")])])]),t._v(" "),s("li",[s("p",[t._v("第二种是有值的，格式如下")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ltm node 名称 {  #这里有换行\n  值\n} #这里有换行\n")])])])])]),t._v(" "),s("p",[t._v("从中可知，"),s("code",[t._v("{")]),t._v("之前的字符串的匹配模式是一样的，不同的是后面。可以分开匹配，或者使用或"),s("code",[t._v("|")]),t._v("一起匹配")]),t._v(" "),s("h3",{attrs:{id:"方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方案"}},[t._v("#")]),t._v(" "),s("strong",[t._v("方案")])]),t._v(" "),s("p",[t._v("1、可以两种匹配方式分开匹配")]),t._v(" "),s("ul",[s("li",[t._v("匹配空pool："),s("code",[t._v("pat = re.compile(r'(?<=ltm\\spool\\s)(.*?){(\\s)}')")]),t._v("*")]),t._v(" "),s("li",[t._v("匹配非空pool："),s("code",[t._v("pat = re.compile(r'(?-s:(?<=ltm\\spool\\s)(.*?){\\n)(.*?)\\n}', flags=re.S)")])])]),t._v(" "),s("p",[t._v("2、使用"),s("code",[t._v("|")]),t._v("结合两种匹配模式")]),t._v(" "),s("ul",[s("li",[t._v("使用："),s("code",[t._v("pat = re.compile(r'(?-s:(?<=ltm\\spool\\s)(.*?){)(\\n.*?\\n|\\s)}', flags=re.S)")]),t._v(" "),s("ul",[s("li",[t._v("但当资源非空时，末行会有空行")])])]),t._v(" "),s("li",[t._v("使用："),s("code",[t._v("pat = re.compile(r'(?-s:(?<=ltm\\spool\\s)(.*?{))(\\n.*?\\n}|\\s})', flags=re.S)")]),t._v(" "),s("ul",[s("li",[t._v("但值的外部加上了"),s("code",[t._v("{}")])])])])]),t._v(" "),s("h3",{attrs:{id:"说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[t._v("#")]),t._v(" "),s("strong",[t._v("说明")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("re.S")]),t._v("：让 "),s("code",[t._v("'.'")]),t._v(" 特殊字符匹配任何字符，包括换行符；如果没有这个标记，"),s("code",[t._v("'.'")]),t._v(" 就匹配 "),s("em",[t._v("除了")]),t._v(" 换行符的其他任意字符。对应内联标记 "),s("code",[t._v("(?s)")])]),t._v(" "),s("li",[s("code",[t._v("(?-s:表达式)")]),t._v("：括号里的表达式取消"),s("code",[t._v("re.S")]),t._v("模式，即只能匹配单行字符串")]),t._v(" "),s("li",[s("code",[t._v("(?<=ltm\\spool\\s)")]),t._v("：匹配以"),s("code",[t._v("ltm空格pool空格")]),t._v("开头的字符串，但不包含"),s("code",[t._v("ltm空格pool空格")])])]),t._v(" "),s("h3",{attrs:{id:"示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" "),s("strong",[t._v("示例")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" re\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bigip.conf'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'r'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" encoding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" f"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \npat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("compile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("r'(?-s:(?<=ltm\\spool\\s)(.*?{))(\\n.*?\\n}|\\s})'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" flags"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("re"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("S"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsource "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("findall"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" source"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f'[source name] ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v(" ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("strong",[t._v("输出")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("[source name] /Common/test1 {  }\n[source name] /Common/mypool { \n    description 测试pool\n    load-balancing-mode ratio-member\n    members {\n        /Common/test:80 {\n            address 192.168.56.20\n            description 测试number\n            priority-group 1\n            rate-limit 1\n            ratio 3\n        }\n        /Common/test22:80 {\n            address 192.168.56.22\n            description 测试number2\n        }\n        /Common/test3:80 {\n            address 192.168.56.11\n            description 测试三\n        }\n        /Common/test6:80 {\n            address 192.168.56.12\n            description 111\n            monitor /Common/http\n        }\n    }\n    min-active-members 2\n    monitor /Common/tcp\n    queue-depth-limit 2\n    queue-time-limit 1\n    reselect-tries 3\n}\n[source name] /Common/test { \n    monitor /Common/http\n}\n[source name] /Common/test5 {  }\n")])])])])}),[],!1,null,null,null);n.default=a.exports}}]);